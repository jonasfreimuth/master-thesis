# Discussion

## Proof of concept

### Normally distributed simulation

The experiment of applying deconvPure to normally distributed random data
demonstrated the theoretical potential of the method for estimating cancer
expression from bulk RNA-seq data.

It showed that indeed, higher variability in one cell-type would lead to
information about the expression of that cell type to be present in the
residuals of a linear deconvolution model applied to the bulk mixture. Further,
it demonstrated that entirely excluding a cell type from the reference profiles
would strongly boost that signal, an effect that is robust to relatively high
amounts of obscuring technical noise. The inherent variability of cells also
appears to only moderately impact estimation accuracy, hinting at an ability of
deconvPure to produce accurate estimates even when the cell types in a tissue
are in different phases of their cell cycle. Lastly, the random simulation
experiment shows that deconvPure's expression estimates contain more information
about the cell type's true expression than is inherently present in the bulk
expression profile.

### scRNA-seq pseudo-bulks

<!-- TODO Discuss relatively high variability for Wilcoxon markers. -->

When applying deconvPure to pseudo-bulks derived from scRNA-seq data, it was
able to achieve high to very high estimation accuracy. This looks very
promising, but the minuteness of the difference in estimation accuracy between
including the cancer profile in the reference or not is not in line with the
behavior expected from the previous simulation experiments. The high
correlations achieved across parameter combinations are even more surprising
when considering the small amount of marker genes that were used to estimate
cell type counts during some deconvolutions (as low as only 62 for the tightest
threshold using Wilcoxon based markers; Table \@ref(tab:pbulk-cexpr-acc-tab)).
Also, the type of marker selection methods used (random vs. Wilcoxon-test based)
doesn't cause a particularly large difference in estimation accuracy, especially
when excluding the cancer profile from the reference.

<!-- TODO Expand on why this leads to residuals correlating with cancer even
when including cancer profiles. -->

The unexpectedly high estimation accuracy, barely influenced by the amount of
marker genes used during deconvolution, could be explained by the relationship
of cell type expression profiles among each other. As seen in Supp. Figure
\@ref(fig:rnd-sim-ground-truth) (D), during random simulation there was
essentially no co-linearity between cell types. This is not the case, however,
for the pseudo-bulks (Supp. Figure \@ref(fig:pbulk-sim-diag-1) (D) &
\@ref(fig:pbulk-sim-diag-2) (D)).

<!-- TODO Discuss acc v prop relationship. -->


## Evaluation

### Comparison to BayesPrism

<!-- TODO Discuss low wilcoxon performance in more detail. -->

<!-- TODO Discuss lower deconvPure performance compared to random pseudo-bulks.
-->

Considering its simplicity, deconvPure's performance on matched pseudo-bulk and
bulk data was rather good in comparison to BayesPrism. While the latter method
mostly showed higher accuracy, the difference was not particularly large and
even disappeared on bulk data for some parameters. However, deconvPure had
slightly lower estimation accuracy on pseudo-bulks derived from real-world tumor
samples than on pseudo-bulks assembled by randomly sampling cells across all
tumor samples.

The performances of BayesPrism on bulk data using random markers is in line with
what @chu.2022 found when benchmarking the method on pseudo-bulks. The apparent
low and variable performance on BayesPrism on pseudo-bulk data using Wilcoxon
based markers may be partly due to the method not allowing for expression
estimation of non-marker genes. As shown in Supp. Table
\@ref(tab:bp-cexpr-acc-plt-tab), the number of genes on which the correlation
measures are based are very different, with the small number probably causing
instability for BayesPrism.

The lower performance of both methods on bulk RNA-seq data compared to pseudo-
bulks is expected to a degree, as there is additional noise present in bulk data
compared to pseudo-bulks, such as different sample preparation. In pseudo-bulks
on the other hand, technical noise shouldn't be a factor impacting the
estimation accuracy as mixtures are created by simple addition of cell
expression. An additional source of error for estimation accuracies on bulk data
is the true value used for the computation of correlations itself. Due to the
differences in general expression characteristic mentioned above, using
scRNA-seq data for the purpose of inferring true cancer expression profiles of
bulk data may result in underestimation, but it is the best thing that was close
to hand. If this is revisited, I believe repeating this comparison using true
cancer expression data from cell sorted bulk RNA-seq experiments would lead to
higher accuracy.

### Prediction

Considering how similar accuracies of models predicting cancer subtype trained
on both estimated cancer expression and matched bulk data were, it seems
unlikely that using estimated cancer expression provides a benefit over simply
using bulk expression data. Nevertheless, the gene set used for model training
appears to have an influence on the prediction accuracy, with the gene set used
by BayesPrism being optimal. Again, both deconvPure use the same set of marker
genes for deconvolution (all genes not removed by the gene level quality control
mentioned in the
[pseudo-bulk proof-of-concept methods](#scrna-seq-pseudo-bulks)), but deconvPure
is able to estimate cancer expression for all genes shared by bulk and reference
profiles. On the other hand, when including tighter thresholds, performance did
not increase (Supp. Figure \@ref(fig:pred-cat-perf-supp-plt), Supp. Table
\@ref(tab:pred-cat-perf-tab)).

From the overall poor prediction accuracy for PFI, it is clear that this is a
challenging outcome to predict. Still, deconvPure was almost entirely unable to
help in predicting PFI, even counterproductive when considering the considerably
higher accuracy of the model trained with matched bulk data. BayesPrism on the
other hand was able to improve prediction accuracy, although not by very much.
This could still be an indication that an improvement in prediction accuracy by
using estimated cancer expression is possible at all, but when considering the
full picture with marker selection, this result appears to be a result of chance
(Supp. Figure \@ref(fig:pred-srv-perf-supp-plt), Supp. Table
\@ref(tab:pred-srv-perf-tab)).

The similar prediction accuracy between models trained on estimated cancer
expression and bulk expression on both prediction tasks may be partly explained
by the strong association between bulk and cancer expression observed during
pseudo-bulk based simulation (Supp. Figure \@ref(fig:pbulk-sim-diag-1) (C) &
\@ref(fig:pbulk-sim-diag-2) (C)). Under the condition of high correlation
between bulk and cancer cell type expression, there is also not much difference
in the information the two measurements hold.

## Conclusion

The principle behind deconvPure is sound and capable of inferring the expression
profile of a cell type from deconvolution residuals when excluding that cell
type's profile from the reference. The method has been benchmarked on pseudo-
bulk data and achieved high accuracy across a wide range of tumor purities.
deconvPure has shown itself to be capable of reasonable estimation accuracy on
cancer expression profiles from bulk data, having similar performance to the
more advanced method of BayesPrism. However, I could not demonstrate a clear
improvement in prediction accuracy for models using cancer expression profiles
estimated by deconvPure.

Since deconvPure is a very simple method, it has multiple straightforward
avenues of further improving its estimation accuracy. The decrease in cell type
accuracy due to the absence of the cancer reference profile could perhaps be
mitigated by using a two-step approach: First estimating cell type proportions
accurately, possibly with some other method better able to account for the
specific challenges of cell type deconvolution, and then using the same approach
of constructing "fitted values" using reference profiles without including the
cancer reference. From that a form of residuals could be computed again and used
as an estimate of cancer expression. Alternatively, the approach used in xCell
[@aran.2017] of correcting cell type estimates by known "spillover" propensities
could mitigate the effect of cancer expression being misattributed to other cell
types and thus leading to selective underestimation of cancer expression. The
best improvement could probably be achieved by simply using as accurate a
reference as can be obtained, for example by replicating experimental conditions
when re-analyzing bulk RNA-seq samples.

Further study might include exploring these improvements to deconvPure alongside
state-of-the-art methods answering actual biological questions. Also, the
estimation accuracy so far has only been assessed on breast cancer data, as I
deemed it out of the scope of this work to find other cancer scRNA-seq datasets.
Perhaps other cancer types have characteristics that are particularly favorable
or challenging for this approach.
