# Supplementary material

```{r supp_setup, include = FALSE}
import::here("here", "here")
import::here("knitr", "include_graphics")
import::here("magrittr", "%>%")
import::here("purrr", "map")
import::here("stringr", "str_extract")

# Suppress chunk output by default.
knitr::opts_chunk$set(echo = FALSE)

here::i_am("bookdown/06-supplementary.Rmd")

import::here(
  "utils.R",
  "main_plot_handles_from_path",
  "supp_plot_handles_from_path",
  .character_only = TRUE,
  .directory = here("modules")
)

analysis_root <- "cancer-cleaning-output"
supp_plot_dir <- "supplementary_plots"
supp_plot_path <- here(paste(analysis_root, supp_plot_dir, sep = "/"))

deconv_diag_pattern <- "deconv_diagnostics_[0-9]+"

deconv_diag_plots <- dir(
  here(supp_plot_path),
  pattern = deconv_diag_pattern
) %>%
  str_extract(deconv_diag_pattern) %>%
  unique() %>%
  set_names(paste0("deconv_diag_", seq_along(.)))


plot_prefixes <- list(
  "rnd_sim_ground_truth" = "ground_truth_plot",
  "rnd_sim_acc_v_abund" = "acc_v_abund_plot"
) %>%
  c(deconv_diag_plots)

supp_plot_handles <- supp_plot_handles_from_path(supp_plot_path, plot_prefixes)

plot_paths <- supp_plot_handles$plot_paths
plot_caps <- supp_plot_handles$plot_caps

# I also want to include some main plots.
main_plot_dir <- "main_plots"
main_plot_path <- here(paste(analysis_root, main_plot_dir, sep = "/"))

main_plot_prefixes <- list(
  "pbulk_acc_v_prop" = "simulation_cancer_acc_v_prop_plot",
  "bp_acc_v_prop" = "bayes_prism_cancer_acc_v_prop_plot"
)

main_plot_handles <- main_plot_handles_from_path(
  main_plot_path, main_plot_prefixes
)

main_plot_paths <- main_plot_handles$plot_paths
main_plot_caps <- main_plot_handles$plot_caps
```

## Supplementary plots

```{r rnd-sim-ground-truth, fig.cap = plot_caps$rnd_sim_ground_truth}
include_graphics(plot_paths$rnd_sim_ground_truth)
```

```{r rnd-sim-acc-abund, fig.cap = plot_caps$rnd_sim_acc_v_abund}
include_graphics(plot_paths$rnd_sim_acc_v_abund)
```

```{r pbulk-sim-diag-1, fig.cap = plot_caps$deconv_diag_1}
include_graphics(plot_paths$deconv_diag_1)
```

```{r pbulk-sim-diag-2, fig.cap = plot_caps$deconv_diag_2}
include_graphics(plot_paths$deconv_diag_2)
```

```{r pbulk-acc-v-abund, fig.cap = main_plot_caps$pbulk_acc_v_prop}
include_graphics(main_plot_paths$pbulk_acc_v_prop)
```

```{r bp-acc-v-abund, fig.cap = main_plot_caps$bp_acc_v_prop}
include_graphics(main_plot_paths$bp_acc_v_prop)
```
